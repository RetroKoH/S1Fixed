; ---------------------------------------------------------------------------
; function to make a little-endian 16-bit pointer for the Z80 sound driver
; ---------------------------------------------------------------------------

z80_ptr function x,(x)<<8&$FF00|(x)>>8&$7F|$80

; ---------------------------------------------------------------------------
; stop the Z80
; ---------------------------------------------------------------------------

SMPS_stopZ80 macro
	SMPS_stopZ80a
	SMPS_waitZ80
	endm

SMPS_stopZ80a macro
	move.w	#$100,(z80_bus_request).l
	endm

; ---------------------------------------------------------------------------
; wait for Z80 to stop
; ---------------------------------------------------------------------------

SMPS_waitZ80 macro

.wait
	btst	#0,(z80_bus_request).l
	bne.s	.wait
	endm

; ---------------------------------------------------------------------------
; reset the Z80
; ---------------------------------------------------------------------------

SMPS_resetZ80 macro
	move.w	#$100,(z80_reset).l
	endm

SMPS_resetZ80a macro
	move.w	#0,(z80_reset).l
	endm

; ---------------------------------------------------------------------------
; start the Z80
; ---------------------------------------------------------------------------

SMPS_startZ80 macro
	move.w	#0,(z80_bus_request).l    ; start the Z80
	endm

; ---------------------------------------------------------------------------
; Pause music
; ---------------------------------------------------------------------------

SMPS_PauseMusic macro
	SMPS_stopZ80
	move.b	#1,(z80_ram+zPauseFlag).l	; pause the music
	SMPS_startZ80
	endm

; ---------------------------------------------------------------------------
; Unpause music
; ---------------------------------------------------------------------------

SMPS_UnpauseMusic macro
	SMPS_stopZ80
	move.b	#$80,(z80_ram+zPauseFlag).l		; unpause music
	SMPS_startZ80
	endm
